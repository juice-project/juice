function _Juice(){this._debugEnabled=false;this._debugWinId="JuiceDebug";this._debugWinSel="#"+this._debugWinId;this._ready=false;this._panels=[];this._meta=[];this._overlayFunc=null;$(document).ready(this._setReady)}_Juice.prototype._setReady=function(){this._ready=true};_Juice.prototype.setDebug=function(A){this._debugEnabled=A};_Juice.prototype.overlayFunc=function(A){if(A!=null){this._overlayFunc=A}return this._overlayFunc};_Juice.prototype.hasMeta=function(C){for(var A=0;A<this._meta.length;A++){var B=this._meta[A];if((C==null||B.getId()==C)&&B.hasMeta()){return true}}return false};_Juice.prototype.addMeta=function(A){this._meta[this._meta.length]=A};_Juice.prototype.getMeta=function(C,A){var B=this.getMetaInstance(C);if(B!=null){return B.get(A)}return null};_Juice.prototype.getMetaInstance=function(C){for(var A=0;A<this._meta.length;A++){var B=this._meta[A];if(B.getId()==C&&B.hasMeta()){return B}}return null};_Juice.prototype.debugMeta=function(){for(var A=0;A<this._meta.length;A++){var B=this._meta[A];if(B.hasMeta()){juice.debugOutln("Meta: "+B.getId()+" - "+B.get())}else{juice.debugOutln("Meta: "+B.getId()+" not set")}}};_Juice.prototype.addPanel=function(A){this._panels[this._panels.length]=A};_Juice.prototype.hasDebugWin=function(){if($(this._debugWinSel).length){return true}return false};_Juice.prototype.debugOutln=function(A){this.debugOut(A+"<br/>")};_Juice.prototype.debugOut=function(A){if(this._debugEnabled){if(!this.hasDebugWin()){this.createDebugWin()}$(this._debugWinSel).append(A)}};_Juice.prototype.createDebugWin=function(){this.appendElement("body","div",this._debugWinId)};_Juice.prototype.appendElement=function(A,C,D){var B="<"+C+' id="'+D+'"></'+C+">";$(A).append(B)};_Juice.prototype.addToPanel=function(D){for(var C=0;C<this._panels.length;C++){var B=D.defPanel();var A=this._panels[C];if((B==null&&!A.shared())||(B!=null&&A.getPanelId()!=B)){continue}A.add(D)}};_Juice.prototype.enableOnPanel=function(D,E){for(var C=0;C<this._panels.length;C++){var B=D.defPanel();var A=this._panels[C];if((B==null&&!A.shared())||(B!=null&&A.getPanelId()!=B)){continue}A.enable(D,E)}};_Juice.prototype.popup_win=null;_Juice.prototype.launchWinH=600;_Juice.prototype.launchWinW=800;_Juice.prototype.launchWinHieght=function(A){if(A!=null){this.launchWinH=A}return this.launchWinH};_Juice.prototype.launchWinWidth=function(A){if(A!=null){this.launchWinW=A}return this.launchWinW};_Juice.prototype.launchWin=function(D,C,B,A){switch(C){case"current":this.launch(D);break;case"overlay":this.launchOverlayWin(B,A);break;case"iframe":this.launchIframeWin(D,B);break;case"iframe-ovelay":var E=this.launchOverlayWin(B,A);this.launchIframeWin(D,E);break;case"new":default:this.launchExternalWin(D);break}};_Juice.prototype.launch=function(A){location.href=A};_Juice.prototype.launchOverlayWin=function(B,A){var C=null;if(this._overlayFunc){if(B instanceof JuiceInsert){B=B.container()}C=this._overlayFunc(B,A)}return C};_Juice.prototype.launchExternalWin=function(A){if(this.popup_win&&!this.popup_win.closed){this.popup_win.close()}this.popup_win=window.open(A,"Juice","width="+this.launchWinW+",height="+this.launchWinH+",toolbar=yes,location=yes,directories=yes,status=yes,menubar=yes,scrollbars=yes,copyhistory=yes,resizable=yes");if(window.focus){this.popup_win.focus()}};_Juice.prototype.launchIframeWin=function(A,B){var C=B;if(B instanceof JuiceInsert){B.show();C=B.getInsertObject()}var D=document.createElement("iframe");D.id="juiframe";D.src=A;D.height=C.height();D.width=C.width();D.scrolling="auto";C.append(D)};var juice=new _Juice();function JuiceInsert(A,D,B){this._container=A;this._insertPoint=D;this._insertType=B;this.shown=[];this._insertObjects=[];this.inserts=$(this.insertPoint).length;for(var C=0;C<this.inserts;C++){this.shown[C]=false;this._insertObjects[C]=null}}JuiceInsert.prototype.container=function(A){if(A!=null){this._container=A}return this._container};JuiceInsert.prototype.insertPoint=function(A){if(A!=null){this._insertPoint=A}return this._insertPoint};JuiceInsert.prototype.insertType=function(A){if(A!=null){this._insertType=A}return this._insertType};JuiceInsert.prototype.insertCount=function(){return this.inserts};JuiceInsert.prototype.insertObjects=function(){return this._insertObjects};JuiceInsert.prototype.showAll=function(){for(var A=0;A<this.inserts;A++){this.show(A)}};JuiceInsert.prototype.show=function(B){if(!B){B=0}var A=this;$(this._insertPoint).each(function(D){if(D==B&&!A.shown[D]){var C=jQuery(A._container);var E=jQuery(this);A._insertObjects[D]=C;switch(A._insertType){case"after":E.after(C);break;case"before":E.before(C);break;case"prepend":E.prepend(C);break;case"append":default:E.append(C);break}A.shown[D]=true}})};JuiceInsert.prototype.getInsertObject=function(A){if(!A){A=0}return this._insertObjects[A]};JuiceInsert.prototype.remove=function(A){if(!A){A=0}if(this.shown[A]){this._insertObjects[A].remove();this._insertObjects[A]=null;this.shown[A]=false}};function JuiceProcess(E,D,A,C,B){this._ready=false;if(arguments.length){this.init(E,D,A,C,B)}}JuiceProcess.prototype.initAndStartup=function(E,D,A,C,B){this.init(E,D,A,C,B);this.startup()};JuiceProcess.prototype.init=function(E,D,A,C,B){this._ProcessId=E;this._startFunc=D;this._selectFunc=A;this._insert=C;this._juice=B;this._ready=true};JuiceProcess.prototype.processId=function(A){if(A!=null){this._ProcessId=A}return this._ProcessId};JuiceProcess.prototype.initFunc=function(A){if(A!=null){this._initFunc=A}return this._initFunc};JuiceProcess.prototype.selectFunc=function(A){if(A!=null){this._selectFunc=A}return this._selectFunc};JuiceProcess.prototype.insert=function(A){if(A!=null){this._insert=A}return this._insert};JuiceProcess.prototype.startupWhenReady=function(){if(this.ready()){this.startup()}else{var A=this;setTimeout(function(){A.startupWhenReady()},5)}};JuiceProcess.prototype.startup=function(){var A=this;setTimeout(function(){A._startup()},2)};JuiceProcess.prototype._startup=function(){if(this._startFunc){this._startFunc(this)}else{this.enable()}};JuiceProcess.prototype.ready=function(){return this._ready};var _JXSPA=[];JuiceProcess.prototype.callbackArrayPos=-1;JuiceProcess.prototype.jsonCallBackPrefix=function(A){var B="_JXSPA["+this.getCallBackPos()+"]";if(A){B+="."+A}return B};JuiceProcess.prototype.getCallBackPos=function(){if(this.callbackArrayPos==-1){_JXSPA[_JXSPA.length]=this;for(var A=0;A<_JXSPA.length;A++){if(_JXSPA[A]==this){break}}this.callbackArrayPos=A}return this.callbackArrayPos};JuiceProcess.prototype.showInsert=function(A){if(this._insert){this._insert.show(A)}};JuiceProcess.prototype.getInsertObjects=function(){if(this._insert){return this._insert.insertObjects()}return[]};JuiceProcess.prototype.getInsertObject=function(A){if(this._insert){return this._insert.getInsertObject(A)}return null};JuiceProcess.prototype.insertCount=function(){if(this._insert){return this._insert.insertCount()}return 0};JuiceProcess.prototype.enable=function(){};function JuiceSelectProcess(H,B,G,F,C,E,D,A){this._ready=false;if(arguments.length){this.init(H,B,G,F,C,E,D,A)}}JuiceSelectProcess.prototype=new JuiceProcess();JuiceSelectProcess.prototype.constructor=JuiceSelectProcess;JuiceSelectProcess.superclass=JuiceProcess.prototype;JuiceSelectProcess.prototype.init=function(H,B,G,F,C,E,D,A){this._iconSrc=B;this._selText=G;this._defPanel=A;JuiceSelectProcess.superclass.init.call(this,H,F,C,E,D);this.addToIconWin();this.startup()};JuiceSelectProcess.prototype.iconSrc=function(A){if(A!=null){this._iconSrc=A}return this._iconSrc};JuiceSelectProcess.prototype.selText=function(A){if(A!=null){this._selText=A}return this._selText};JuiceSelectProcess.prototype.defPanel=function(A){if(A!=null){this._defPanel=A}return this._defPanel};JuiceSelectProcess.prototype.addToIconWin=function(){this._juice.addToPanel(this)};JuiceSelectProcess.prototype.enable=function(A){this._juice.enableOnPanel(this,A)};JuiceSelectProcess.prototype.getSelectFunction=function(A){if(!A){A=0}var B=this.getCallBackPos();return(function(){_JXSPA[B]._selectFunc(A)})};function JuicePanel(D,E,C,B,A){this.init(D,E,C,B,A)}JuicePanel.prototype.init=function(D,E,C,B,A){this._panelId=E;this._insertDiv=D;this._startClass=C;this._liveClass=B;this._showFunc=A;this.inserted=false;this.shown=false;this._shared=true};JuicePanel.prototype.getPanelId=function(){return this._panelId};JuicePanel.prototype.startClass=function(A){if(A!=null){this._startClass=A}return this._startClass};JuicePanel.prototype.liveClass=function(A){if(A!=null){this._liveClass=A}return this._liveClass};JuicePanel.prototype.showFunc=function(A){if(A!=null){this._showFunc=A}return this._showFunc};JuicePanel.prototype.shared=function(A){if(A!=null){this._shared=A}return this._shared};JuicePanel.prototype.insert=function(){if(!this.inserted){this._insertDiv.showAll();this.inserted=true}};JuicePanel.prototype.show=function(){if(jQuery.isFunction(this._showFunc)&&!this.shown){this._showFunc();this.shown=true}};JuicePanel.prototype.add=function(D){this.insert();this.show();var C=this._insertDiv.insertObjects();for(var B=0;B<C.length;B++){var E=this.makeId(D,B);var A='<img title="'+D.selText()+'" id="'+E+'" class="'+this.startClass()+'" src="'+D.iconSrc()+'" />';C[B].append(A)}D.insert(this._insertDiv)};JuicePanel.prototype.enable=function(D,F){var C=D.getSelectFunction(F);var E=this.makeId(D,F);var B=this.startClass().split(" ");for(var A=0;A<B.length;A++){$("#"+E).removeClass(B[A])}B=this.liveClass().split(" ");for(var A=0;A<B.length;A++){$("#"+E).addClass(B[A])}$("#"+E).click(C)};JuicePanel.prototype.makeId=function(A,B){if(!B){B=0}return this.getPanelId()+"-"+A.processId()+"-"+B};function JuiceMeta(C,A,B){JuiceMeta.superclass.init.call(this,C,A,null,B)}JuiceMeta.prototype=new JuiceMetaAttr();JuiceMeta.prototype.constructor=JuiceMeta;JuiceMeta.superclass=JuiceMetaAttr.prototype;function JuiceMetaAttr(D,A,C,B){if(arguments.length){this.init(D,A,C,B)}}JuiceMetaAttr.prototype.init=function(D,A,C,B){this.id=D;this._selector=A;this._attName=C;this._filterFunc=B;this._values=[];this._found=false;this._find()};JuiceMetaAttr.prototype.get=function(A){if(A==null){A=0}return this._values[A]};JuiceMetaAttr.prototype.getLength=function(){return this._values.length};JuiceMetaAttr.prototype.getId=function(){return this.id};JuiceMetaAttr.prototype.hasMeta=function(){return this._found};JuiceMetaAttr.prototype._find=function(){var B=this;var A=0;$(this._selector).each(function(){var C;if(B._attName){C=$(this).attr(B._attName)}else{C=$(this).text()}if(jQuery.isFunction(B._filterFunc)){B._values[A]=B._filterFunc(C,B)}else{B._values[A]=C}if(C.length>0){B._found=true}A++})};_Juice.prototype.runscript=function(C,B){$("#"+C).remove();var A='<script id="'+C+'" src="'+B+'" type="text/javascript"><\/script>';$(document).prepend(A)};function JsLoadFlag(A){this.name=A;this.loaded=false}_Juice.prototype.JsLoadFlags=[];_Juice.prototype.loadJs=function(B,A){if(this.findJs(B)){if(A){A()}return }this._loadFile(B,"js",A)};_Juice.prototype.loadCss=function(A){this._loadFile(A,"css")};_Juice.prototype._loadFile=function(D,E,B){var F=this;var G=B;var C=document.getElementsByTagName("head")[0];var A=null;if(E=="js"){A=document.createElement("script");A.type="text/javascript";A.src=D}else{if(E=="css"){A=document.createElement("link");A.type="text/css";A.rel="stylesheet";A.href=D}}C.appendChild(A);if(E=="js"){F.JsLoadFlags[this.JsLoadFlags.length]=new JsLoadFlag(D);A.onreadystatechange=function(){if(A.readyState=="loaded"||A.readyState=="complete"){if(G){G()}F.jsOnLoadEvent(D)}};A.onload=function(){if(G){G()}F.jsOnLoadEvent(D)}}};_Juice.prototype.findJs=function(C){var A=document.getElementsByTagName("script");for(var B=0;B<A.length;B++){if(A[B].getAttribute("src")==C){return true}}return false};_Juice.prototype.jsOnLoadEvent=function(B){var A=this.JsLoadFlags;for(var C=0;C<A.length;C++){if(B==A[C].name){A[C].loaded=true;break}}};_Juice.prototype.onJsLoaded=function(A){var B=this;if(this.isJsLoaded()){A()}else{setTimeout(function(){B.onJsLoaded(A)},5)}};_Juice.prototype.isJsLoaded=function(){if(this.JsNotLoaded().length){return false}return true};_Juice.prototype.JsNotLoaded=function(){var B=[];var A=this.JsLoadFlags;for(var C=0;C<A.length;C++){if(!A[C].loaded){B[B.length]=A[C].name}}return B};_Juice.prototype.nums="0123456789";_Juice.prototype.lc="abcdefghijklmnopqrstuvwxyz";_Juice.prototype.uc="ABCDEFGHIJKLMNOPQRSTUVWXYZ";_Juice.prototype.isVal=function(A,B){if(A==""){return true}for(i=0;i<A.length;i++){if(B.indexOf(A.charAt(i),0)==-1){return false}}return true};_Juice.prototype.isnumser=function(A){return juice.isVal(A,juice.nums)};_Juice.prototype.isLower=function(A){return juice.isVal(A,juice.lc)};_Juice.prototype.isUpper=function(A){return juice.isVal(A,juice.uc)};_Juice.prototype.isAlpha=function(A){return juice.isVal(A,juice.lc+juice.uc)};_Juice.prototype.isAlphanum=function(A){return juice.isVal(A,juice.lc+juice.uc+juice.nums)};_Juice.prototype.stringToAlphnumAray=function(D){var A=[];var C=0;var B=juice.stringToArray(D);for(j=0;j<B.length;j++){if(juice.isAlphanum(B[j])){A[C++]=B[j]}}return A};_Juice.prototype.stringToArray=function(G,D){var B=" \t\n\r"+D;var C;var A=[];var F=0;while(G!=""){C=0;while(C<G.length&&juice.isSepChar(G.charAt(C),B)){C++}if(C<G.length){var E="";while(C<G.length&&!juice.isSepChar(G.charAt(C),B)){E+=G.charAt(C);C++}A[F]=E;F++}G=G.substring(C+1,G.length)}return A};_Juice.prototype.isSepChar=function(B,C){var A=" \t\n\r";if(C==null||C==""){A=C}return(A.indexOf(B)!=-1)};_Juice.prototype.toArray=function(B){var A=[];if(!B){return A}else{if(typeof B=="string"){A[0]=B}else{if(!B[0]){A[0]=B}else{A=B}}}return A};function testDebug(A){if(this._debugEnabled){div=document.getElementById("ExtendDebug");if(div){div.innerHTML+=" "+A}}};
